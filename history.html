<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UTM Manager - æˆ‘çš„é€£çµ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="shared/styles.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body>
  <!-- å°èˆªåˆ— -->
  <nav class="bg-white shadow-sm border-b border-gray-100 px-6 py-4">
    <div class="max-w-7xl mx-auto flex justify-between items-center">
      <div class="flex items-center gap-3">
        <div class="w-8 h-8 bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg flex items-center justify-center">
          <i class="fas fa-link text-white text-sm"></i>
        </div>
        <h1 class="text-xl font-semibold text-gray-900">UTM Manager</h1>
      </div>
      <div class="flex gap-2">
        <a href="index.html" class="nav-tab-modern">
          <i class="fas fa-magic"></i>
          <span>ç”¢ç”Ÿå™¨</span>
        </a>
        <a href="history.html" class="nav-tab-modern nav-tab-active">
          <i class="fas fa-history"></i>
          <span>æˆ‘çš„é€£çµ</span>
        </a>
        <a href="templates.html" class="nav-tab-modern">
          <i class="fas fa-bookmark"></i>
          <span>å¸¸ç”¨ç¯„æœ¬</span>
        </a>
      </div>
    </div>
  </nav>

  <!-- ä¸»è¦å…§å®¹ -->
  <div class="min-h-screen bg-gray-50">
    <div class="max-w-7xl mx-auto px-6 py-8">
      <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-8">
        <div class="text-center mb-8">
          <div class="w-16 h-16 bg-gradient-to-r from-green-500 to-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-4">
            <i class="fas fa-history text-white text-2xl"></i>
          </div>
          <h1 class="text-3xl font-bold text-gray-900 mb-2">æˆ‘çš„é€£çµè¨˜éŒ„</h1>
          <p class="text-gray-600">ç®¡ç†å’Œè¿½è¹¤ä½ çš„ UTM é€£çµ</p>
        </div>
      
        <!-- åŠŸèƒ½ç‹€æ…‹é¡¯ç¤º -->
        <div class="mb-6 flex justify-end">
          <div class="flex gap-4 text-sm">
            <div class="flex items-center gap-2 px-3 py-1 bg-gray-50 rounded-lg">
              <i class="fas fa-table text-green-500"></i>
              <span class="text-gray-600">Google Sheet:</span>
              <div id="syncStatus"></div>
            </div>
          </div>
        </div>

        <!-- æœå°‹å’Œç¯©é¸ -->
        <div class="mb-8 flex flex-col sm:flex-row gap-4">
          <div class="flex-1">
            <div class="relative">
              <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
              <input type="text" id="searchInput" placeholder="æœå°‹æ´»å‹•åç¨±..." 
                     class="w-full pl-10 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
            </div>
          </div>
          <div>
            <select id="timeFilter" class="px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
              <option value="all">å…¨éƒ¨æ™‚é–“</option>
              <option value="today">ä»Šå¤©</option>
              <option value="week">æœ¬é€±</option>
              <option value="month">æœ¬æœˆ</option>
            </select>
          </div>
          <div class="flex gap-3">
            <button id="syncRecords" class="bg-gradient-to-r from-blue-500 to-blue-600 text-white px-6 py-3 rounded-xl font-medium hover:from-blue-600 hover:to-blue-700 transition-all flex items-center gap-2">
              <i class="fas fa-sync-alt"></i>
              åŒæ­¥è‡³ Google Sheet
            </button>
            <button id="clearAll" class="bg-white border border-gray-200 text-gray-700 px-6 py-3 rounded-xl font-medium hover:bg-gray-50 transition-all flex items-center gap-2">
              <i class="fas fa-trash-alt"></i>
              æ¸…ç©ºè¨˜éŒ„
            </button>
          </div>
        </div>

        <!-- è¨­å®šé ˆçŸ¥ -->
        <div class="mb-6 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-100 rounded-2xl">
          <div class="flex items-center gap-2 mb-4">
            <i class="fas fa-cog text-blue-600"></i>
            <h3 class="text-lg font-semibold text-gray-900">è¨­å®šé ˆçŸ¥</h3>
          </div>
          <div class="flex flex-wrap gap-3">
            <button id="cloudSync" class="bg-white border border-orange-200 text-orange-700 px-4 py-2 rounded-xl font-medium hover:bg-orange-50 transition-all flex items-center gap-2">
              <i class="fas fa-cloud-upload-alt"></i>
              é›²ç«¯åŒæ­¥
            </button>
            <a href="firebase-setup.html" class="bg-white border border-red-200 text-red-700 px-4 py-2 rounded-xl font-medium hover:bg-red-50 transition-all flex items-center gap-2 no-underline">
              <i class="fas fa-fire"></i>
              Firebase è¨­å®š
            </a>
            <button id="syncSettings" class="bg-white border border-blue-200 text-blue-700 px-4 py-2 rounded-xl font-medium hover:bg-blue-50 transition-all flex items-center gap-2">
              <i class="fas fa-table"></i>
              Google Sheet è¨­å®š
            </button>
            <a href="sync-setup.html" class="bg-white border border-blue-200 text-blue-700 px-4 py-2 rounded-xl font-medium hover:bg-blue-50 transition-all flex items-center gap-2 no-underline">
              <i class="fas fa-book"></i>
              åŒæ­¥èªªæ˜
            </a>
          </div>
        </div>

      <!-- è¨˜éŒ„åˆ—è¡¨ -->
      <div id="recordsList" class="space-y-3">
        <!-- è¨˜éŒ„é …ç›®å°‡åœ¨é€™è£¡å‹•æ…‹ç”Ÿæˆ -->
      </div>

      <!-- ç©ºç‹€æ…‹ -->
      <div id="emptyState" class="text-center py-12 text-gray-500 hidden">
        <div class="text-4xl mb-4">ğŸ“</div>
        <p>é‚„æ²’æœ‰ä»»ä½•è¨˜éŒ„</p>
        <p class="text-sm mt-2">
          <a href="index.html" class="text-blue-600 hover:underline">å‰å¾€ç”¢ç”Ÿå™¨</a> å»ºç«‹ä½ çš„ç¬¬ä¸€å€‹ UTM é€£çµ
        </p>
      </div>

      <!-- åŒæ­¥é€²åº¦ -->
      <div id="syncProgress" class="hidden mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg">
        <div class="flex justify-between items-center mb-2">
          <span class="font-medium text-blue-900">æ­£åœ¨åŒæ­¥...</span>
          <span id="syncProgressText" class="text-sm text-blue-700">0/0</span>
        </div>
        <div class="w-full bg-blue-200 rounded-full h-2">
          <div id="syncProgressBar" class="bg-blue-600 h-2 rounded-full transition-all" style="width: 0%"></div>
        </div>
      </div>

      <div id="statusMessage" class="text-center text-sm mt-4"></div>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
  
  <script src="shared/utils.js"></script>
  <script src="shared/sync-api.js"></script>
  <script src="shared/url-shortener.js"></script>
  <script src="shared/firebase-storage.js"></script>
  <script>
    let allRecords = [];
    let filteredRecords = [];

    // DOM å…ƒç´ 
    const elements = {
      searchInput: document.getElementById('searchInput'),
      timeFilter: document.getElementById('timeFilter'),
      clearAll: document.getElementById('clearAll'),
      recordsList: document.getElementById('recordsList'),
      emptyState: document.getElementById('emptyState')
    };

    // è¼‰å…¥è¨˜éŒ„
    function loadRecords() {
      allRecords = Storage.get('utm_records') || [];
      filterRecords();
    }

    // ç¯©é¸è¨˜éŒ„
    function filterRecords() {
      const searchTerm = elements.searchInput.value.toLowerCase();
      const timeFilter = elements.timeFilter.value;
      
      filteredRecords = allRecords.filter(record => {
        // æœå°‹ç¯©é¸
        const matchesSearch = !searchTerm || 
          record.utmCampaign.toLowerCase().includes(searchTerm) ||
          record.websiteUrl.toLowerCase().includes(searchTerm);
        
        // æ™‚é–“ç¯©é¸
        const recordDate = new Date(record.timestamp);
        const now = new Date();
        let matchesTime = true;
        
        switch (timeFilter) {
          case 'today':
            matchesTime = recordDate.toDateString() === now.toDateString();
            break;
          case 'week':
            const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
            matchesTime = recordDate >= weekAgo;
            break;
          case 'month':
            const monthAgo = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
            matchesTime = recordDate >= monthAgo;
            break;
        }
        
        return matchesSearch && matchesTime;
      });
      
      renderRecords();
    }

    // æ¸²æŸ“è¨˜éŒ„åˆ—è¡¨
    function renderRecords() {
      if (filteredRecords.length === 0) {
        elements.recordsList.innerHTML = '';
        elements.emptyState.classList.remove('hidden');
        return;
      }
      
      elements.emptyState.classList.add('hidden');
      
      elements.recordsList.innerHTML = filteredRecords.map(record => {
        const date = new Date(record.timestamp).toLocaleString('zh-TW');
        return `
          <div class="bg-gray-50 p-4 rounded-lg border">
            <div class="flex justify-between items-start mb-2">
              <div class="flex-1">
                <h3 class="font-medium text-gray-900">${record.utmCampaign}</h3>
                <p class="text-sm text-gray-600">${record.websiteUrl}</p>
                <div class="text-xs text-gray-500 mt-1">
                  ${record.utmSource} / ${record.utmMedium} â€¢ ${date}
                </div>
              </div>
              <div class="flex gap-2 ml-4 flex-wrap">
                <button onclick="copyRecord('${record.finalUrl}')" class="text-blue-600 hover:text-blue-800 text-xs">
                  ğŸ“‹ è¤‡è£½é€£çµ
                </button>
                ${record.shortUrl ? 
                  `<button onclick="copyRecord('${record.shortUrl}')" class="text-green-600 hover:text-green-800 text-xs">
                    âœ¨ è¤‡è£½çŸ­ç¶²å€
                  </button>` : 
                  `<button onclick="createShortUrlForRecord('${record.timestamp}')" class="text-purple-600 hover:text-purple-800 text-xs">
                    âœ¨ ç”¢ç”ŸçŸ­ç¶²å€
                  </button>`
                }
                <button onclick="syncSingleRecord('${record.timestamp}')" class="text-green-600 hover:text-green-800 text-xs">
                  ğŸ”„ åŒæ­¥
                </button>
                <button onclick="deleteRecord('${record.timestamp}')" class="text-red-600 hover:text-red-800 text-xs">
                  ğŸ—‘ï¸ åˆªé™¤
                </button>
              </div>
            </div>
            <div class="bg-white p-2 rounded text-xs">
              <div class="mb-1 text-gray-700 break-all">ğŸ”— ${record.finalUrl}</div>
              <div id="shortUrl-${record.timestamp}" class="${record.shortUrl ? '' : 'hidden'} text-green-600 break-all">
                âœ¨ ${record.shortUrl || ''}
              </div>
            </div>
          </div>
        `;
      }).join('');
    }

    // è¤‡è£½è¨˜éŒ„
    async function copyRecord(url) {
      const success = await copyToClipboard(url);
      showStatus(success ? 'é€£çµå·²è¤‡è£½ï¼' : 'è¤‡è£½å¤±æ•—', success ? 'success' : 'error');
    }

    // åˆªé™¤è¨˜éŒ„
    function deleteRecord(timestamp) {
      if (!confirm('ç¢ºå®šè¦åˆªé™¤é€™ç­†è¨˜éŒ„å—ï¼Ÿ')) return;
      
      allRecords = allRecords.filter(record => record.timestamp !== timestamp);
      Storage.set('utm_records', allRecords);
      filterRecords();
      showStatus('è¨˜éŒ„å·²åˆªé™¤', 'success');
    }

    // æ¸…ç©ºæ‰€æœ‰è¨˜éŒ„
    function clearAllRecords() {
      if (!confirm('ç¢ºå®šè¦æ¸…ç©ºæ‰€æœ‰è¨˜éŒ„å—ï¼Ÿæ­¤æ“ä½œç„¡æ³•å¾©åŸã€‚')) return;
      
      Storage.remove('utm_records');
      allRecords = [];
      filterRecords();
      showStatus('æ‰€æœ‰è¨˜éŒ„å·²æ¸…ç©º', 'success');
    }

    // é è¨­è¨­å®šï¼ˆè‡¨æ™‚ï¼‰
    function initializeDefaultSettings() {
      // é è¨­ Google Apps Script URL
      if (!Storage.get('sync_api_url')) {
        Storage.set('sync_api_url', 'https://script.google.com/macros/s/AKfycbxmXzmwyGQhnnR2k3XsYIfSYV-601e8keq9qftoG8mi9hZnEIIOpqMPYY1RO5x6B33p-g/exec');
      }
      
      // é è¨­ Gemini API Key
      if (!Storage.get('gemini_api_key')) {
        Storage.set('gemini_api_key', 'AIzaSyBVep_ohPIfsljmqljiNrL8EN03J3PMSMw');
      }
    }

    // äº‹ä»¶ç¶å®š
    document.addEventListener('DOMContentLoaded', () => {
      // åˆå§‹åŒ–é è¨­è¨­å®š
      initializeDefaultSettings();
      
      // æœå°‹å’Œç¯©é¸
      elements.searchInput.addEventListener('input', filterRecords);
      elements.timeFilter.addEventListener('change', filterRecords);
      elements.clearAll.addEventListener('click', clearAllRecords);
      document.getElementById('syncRecords').addEventListener('click', syncToGoogleSheet);
      document.getElementById('syncSettings').addEventListener('click', showSyncSettings);
      
      // è¼‰å…¥è¨˜éŒ„
      loadRecords();
      updateSyncStatus();
    });

    // åŒæ­¥åŠŸèƒ½
    async function syncToGoogleSheet() {
      if (!syncManager.checkConfig()) {
        showStatus('è«‹å…ˆè¨­å®š Google Apps Script URL', 'error');
        showSyncSettings();
        return;
      }

      if (filteredRecords.length === 0) {
        showStatus('æ²’æœ‰è¨˜éŒ„å¯åŒæ­¥', 'error');
        return;
      }

      const confirmMsg = `ç¢ºå®šè¦åŒæ­¥ ${filteredRecords.length} ç­†è¨˜éŒ„åˆ° Google Sheet å—ï¼Ÿ`;
      if (!confirm(confirmMsg)) return;

      const progressEl = document.getElementById('syncProgress');
      const progressTextEl = document.getElementById('syncProgressText');
      const progressBarEl = document.getElementById('syncProgressBar');
      
      progressEl.classList.remove('hidden');
      
      try {
        const result = await syncManager.syncMultipleRecords(filteredRecords, (progress) => {
          const percentage = Math.round((progress.current / progress.total) * 100);
          progressTextEl.textContent = `${progress.current}/${progress.total} (æˆåŠŸ: ${progress.successCount}, å¤±æ•—: ${progress.errorCount})`;
          progressBarEl.style.width = `${percentage}%`;
        });
        
        progressEl.classList.add('hidden');
        
        if (result.errorCount === 0) {
          showStatus(`âœ… æˆåŠŸåŒæ­¥ ${result.successCount} ç­†è¨˜éŒ„ï¼`, 'success');
        } else {
          showStatus(`âš ï¸ åŒæ­¥å®Œæˆï¼šæˆåŠŸ ${result.successCount} ç­†ï¼Œå¤±æ•— ${result.errorCount} ç­†`, 'warning');
          
          // é¡¯ç¤ºè©³ç´°éŒ¯èª¤è¨Šæ¯
          const errorDetails = result.results
            .filter(r => !r.success)
            .map(r => `ç¬¬${r.index + 1}ç­†: ${r.error}`)
            .join('\n');
          
          if (errorDetails && confirm('æ˜¯å¦æŸ¥çœ‹è©³ç´°éŒ¯èª¤è¨Šæ¯ï¼Ÿ')) {
            alert(`åŒæ­¥å¤±æ•—è©³æƒ…ï¼š\n\n${errorDetails}`);
          }
        }
      } catch (error) {
        progressEl.classList.add('hidden');
        showStatus(`âŒ åŒæ­¥å¤±æ•—ï¼š${error.message}`, 'error');
      }
    }

    function showSyncSettings() {
      const hasUrl = syncManager.checkConfig();
      
      if (hasUrl) {
        const action = confirm('ç›®å‰å·²è¨­å®š Google Apps Script URL\n\né»æ“Šã€Œç¢ºå®šã€æ›´æ› URL\né»æ“Šã€Œå–æ¶ˆã€ç§»é™¤ URL');
        
        if (action) {
          // æ›´æ› URL
          const newUrl = prompt('è«‹è¼¸å…¥æ–°çš„ Google Apps Script Web App URLï¼š\n\næ ¼å¼ç¯„ä¾‹ï¼š\nhttps://script.google.com/macros/s/YOUR_SCRIPT_ID/exec', syncManager.apiUrl);
          if (newUrl && newUrl.trim()) {
            syncManager.setApiUrl(newUrl.trim());
            updateSyncStatus();
            showStatus('Apps Script URL å·²æ›´æ–°ï¼', 'success');
            testSyncConnection();
          }
        } else {
          // ç§»é™¤ URL
          if (confirm('ç¢ºå®šè¦ç§»é™¤ Apps Script URL å—ï¼Ÿ')) {
            syncManager.setApiUrl('');
            updateSyncStatus();
            showStatus('Apps Script URL å·²ç§»é™¤', 'info');
          }
        }
      } else {
        // æ–°å¢ URL
        const newUrl = prompt('è«‹è¼¸å…¥ä½ çš„ Google Apps Script Web App URLï¼š\n\næ ¼å¼ç¯„ä¾‹ï¼š\nhttps://script.google.com/macros/s/YOUR_SCRIPT_ID/exec');
        
        if (newUrl && newUrl.trim()) {
          syncManager.setApiUrl(newUrl.trim());
          updateSyncStatus();
          showStatus('Apps Script URL å·²è¨­å®šï¼', 'success');
          testSyncConnection();
        }
      }
    }
    
    function updateSyncStatus() {
      const statusEl = document.getElementById('syncStatus');
      const hasUrl = syncManager.checkConfig();
      
      if (hasUrl) {
        statusEl.innerHTML = '<span class="inline-flex items-center gap-1 text-green-600 font-medium"><i class="fas fa-check-circle"></i> å·²è¨­å®š</span>';
      } else {
        statusEl.innerHTML = '<span class="inline-flex items-center gap-1 text-red-500 font-medium"><i class="fas fa-times-circle"></i> æœªè¨­å®š</span>';
      }
    }

    async function testSyncConnection() {
      try {
        showStatus('æ­£åœ¨æ¸¬è©¦é€£ç·š...', 'info');
        await syncManager.testConnection();
        showStatus('âœ… Google Sheet é€£ç·šæ­£å¸¸ï¼', 'success');
      } catch (error) {
        showStatus(`âŒ é€£ç·šæ¸¬è©¦å¤±æ•—ï¼š${error.message}`, 'error');
      }
    }

    // å–®ç­†åŒæ­¥æ¸¬è©¦
    async function syncSingleRecord(timestamp) {
      const record = allRecords.find(r => r.timestamp === timestamp);
      if (!record) {
        showStatus('æ‰¾ä¸åˆ°è¨˜éŒ„', 'error');
        return;
      }
      
      if (!syncManager.checkConfig()) {
        showStatus('è«‹å…ˆè¨­å®š Google Apps Script URL', 'error');
        showSyncSettings();
        return;
      }
      
      try {
        showStatus('æ­£åœ¨åŒæ­¥å–®ç­†è¨˜éŒ„...', 'info');
        await syncManager.syncRecord(record);
        showStatus('âœ… å–®ç­†è¨˜éŒ„åŒæ­¥æˆåŠŸï¼', 'success');
      } catch (error) {
        showStatus(`âŒ å–®ç­†åŒæ­¥å¤±æ•—: ${error.message}`, 'error');
        console.error('å–®ç­†åŒæ­¥éŒ¯èª¤:', error);
      }
    }

    // è¡¨å–®æ¸¬è©¦åŒæ­¥
    async function testFormSync(timestamp) {
      const record = allRecords.find(r => r.timestamp === timestamp);
      if (!record) {
        showStatus('æ‰¾ä¸åˆ°è¨˜éŒ„', 'error');
        return;
      }
      
      if (!syncManager.checkConfig()) {
        showStatus('è«‹å…ˆè¨­å®š Google Apps Script URL', 'error');
        return;
      }
      
      try {
        showStatus('æ­£åœ¨ä½¿ç”¨è¡¨å–®æ–¹å¼åŒæ­¥...', 'info');
        await syncManager.syncWithForm(record);
        showStatus('âœ… è¡¨å–®åŒæ­¥å®Œæˆï¼è«‹æª¢æŸ¥ Google Sheet', 'success');
      } catch (error) {
        showStatus(`âŒ è¡¨å–®åŒæ­¥å¤±æ•—: ${error.message}`, 'error');
      }
    }

    // ç‚ºå–®ç­†è¨˜éŒ„ç”¢ç”ŸçŸ­ç¶²å€
    async function createShortUrlForRecord(timestamp) {
      const record = allRecords.find(r => r.timestamp === timestamp);
      if (!record) {
        showStatus('æ‰¾ä¸åˆ°è¨˜éŒ„', 'error');
        return;
      }
      
      if (record.shortUrl) {
        showStatus('é€™ç­†è¨˜éŒ„å·²æœ‰çŸ­ç¶²å€', 'info');
        return;
      }
      
      try {
        showStatus('æ­£åœ¨ç”¢ç”ŸçŸ­ç¶²å€...', 'info');
        
        const options = {
          title: `UTM: ${record.utmCampaign || 'è¡ŒéŠ·æ´»å‹•'}`,
          description: `ä¾†æº: ${record.utmSource} | åª’ä»‹: ${record.utmMedium}`
        };
        
        const result = await urlShortener.createShortUrl(record.finalUrl, options);
        
        // æ›´æ–°è¨˜éŒ„
        record.shortUrl = result.shortUrl;
        Storage.set('utm_records', allRecords);
        
        // æ›´æ–°é¡¯ç¤º
        const shortUrlEl = document.getElementById(`shortUrl-${timestamp}`);
        if (shortUrlEl) {
          shortUrlEl.innerHTML = `âœ¨ ${result.shortUrl}`;
          shortUrlEl.classList.remove('hidden');
        }
        
        // é‡æ–°æ¸²æŸ“åˆ—è¡¨ä»¥æ›´æ–°æŒ‰éˆ•
        renderRecords();
        
        showStatus('âœ… çŸ­ç¶²å€å·²ç”¢ç”Ÿï¼', 'success');
        
        // åŒæ­¥åˆ°Google Sheet
        if (syncManager.checkConfig()) {
          const shouldSync = confirm('çŸ­ç¶²å€å·²ç”¢ç”Ÿã€‚\n\næ˜¯å¦è¦åŒæ­¥æ›´æ–°åˆ° Google Sheetï¼Ÿ');
          if (shouldSync) {
            try {
              await syncManager.syncRecord(record);
              showStatus('âœ… å·²åŒæ­¥æ›´æ–°åˆ° Google Sheetï¼', 'success');
            } catch (error) {
              showStatus(`åŒæ­¥å¤±æ•—: ${error.message}`, 'warning');
            }
          }
        }
        
      } catch (error) {
        showStatus(`ç¸®ç¶²å€å¤±æ•—: ${error.message}`, 'error');
      }
    }

    // å…¨åŸŸå‡½æ•¸ï¼ˆä¾› HTML ä¸­çš„ onclick ä½¿ç”¨ï¼‰
    window.copyRecord = copyRecord;
    window.deleteRecord = deleteRecord;
    window.syncSingleRecord = syncSingleRecord;
    window.testFormSync = testFormSync;
    window.createShortUrlForRecord = createShortUrlForRecord;
  </script>

  <style>
    .nav-tab-modern {
      @apply flex items-center gap-2 px-4 py-2 rounded-xl text-sm font-medium transition-all no-underline;
      @apply text-gray-600 hover:text-gray-900 hover:bg-gray-100;
    }
    
    .nav-tab-active {
      @apply bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-sm;
    }
    
    .nav-tab-active:hover {
      @apply from-blue-600 to-blue-700 text-white;
    }
    
    .status-success { @apply text-green-600; }
    .status-error { @apply text-red-600; }
    .status-info { @apply text-blue-600; }
    .status-warning { @apply text-orange-600; }
  </style>
</body>
</html>